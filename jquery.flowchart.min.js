$(function () { $.widget("flowchart.flowchart", { options: { canUserEditLinks: !0, canUserMoveOperators: !0, data: {}, distanceFromArrow: 3, defaultOperatorClass: "flowchart-default-operator", defaultLinkColor: "#3366ff", defaultSelectedLinkColor: "black", linkWidth: 10, grid: 20, multipleLinksOnOutput: !1, multipleLinksOnInput: !1, linkVerticalDecal: 0, onOperatorSelect: function (t) { return !0 }, onOperatorUnselect: function () { return !0 }, onOperatorMouseOver: function (t) { return !0 }, onOperatorMouseOut: function (t) { return !0 }, onLinkSelect: function (t) { return !0 }, onLinkUnselect: function () { return !0 }, onOperatorCreate: function (t, e, o) { return !0 }, onLinkCreate: function (t, e) { return !0 }, onOperatorDelete: function (t) { return !0 }, onLinkDelete: function (t, e) { return !0 }, onOperatorMoved: function (t, e) { }, onAfterChange: function (t) { } }, data: null, objs: null, maskNum: 0, linkNum: 0, operatorNum: 0, lastOutputConnectorClicked: null, selectedOperatorId: null, selectedLinkId: null, positionRatio: 1, globalId: null, _create: function () { void 0 === document.__flowchartNumber ? document.__flowchartNumber = 0 : document.__flowchartNumber++, this.globalId = document.__flowchartNumber, this._unitVariables(), this.element.addClass("flowchart-container"), this.objs.layers.links = $('<svg class="flowchart-links-layer"></svg>'), this.objs.layers.links.appendTo(this.element), this.objs.layers.operators = $('<div class="flowchart-operators-layer unselectable"></div>'), this.objs.layers.operators.appendTo(this.element), this.objs.layers.temporaryLink = $('<svg class="flowchart-temporary-link-layer"></svg>'), this.objs.layers.temporaryLink.appendTo(this.element); var t = document.createElementNS("http://www.w3.org/2000/svg", "line"); t.setAttribute("x1", "0"), t.setAttribute("y1", "0"), t.setAttribute("x2", "0"), t.setAttribute("y2", "0"), t.setAttribute("stroke-dasharray", "6,6"), t.setAttribute("stroke-width", "4"), t.setAttribute("stroke", "black"), t.setAttribute("fill", "none"), this.objs.layers.temporaryLink[0].appendChild(t), this.objs.temporaryLink = t, this._initEvents(), void 0 !== this.options.data && this.setData(this.options.data) }, _unitVariables: function () { this.data = { operators: {}, links: {} }, this.objs = { layers: { operators: null, temporaryLink: null, links: null }, linksContext: null, temporaryLink: null } }, _initEvents: function () { var t = this; this.element.mousemove(function (e) { var o = $(this).offset(); t._mousemove((e.pageX - o.left) / t.positionRatio, (e.pageY - o.top) / t.positionRatio, e) }), this.element.click(function (e) { var o = $(this).offset(); t._click((e.pageX - o.left) / t.positionRatio, (e.pageY - o.top) / t.positionRatio, e) }), this.objs.layers.operators.on("pointerdown mousedown touchstart", ".flowchart-operator", function (t) { t.stopImmediatePropagation() }), this.objs.layers.operators.on("click", ".flowchart-operator", function (e) { 0 == $(e.target).closest(".flowchart-operator-connector").length && t.selectOperator($(this).data("operator_id")) }), this.objs.layers.operators.on("click", ".flowchart-operator-connector", function () { var e = $(this); t.options.canUserEditLinks && t._connectorClicked(e.closest(".flowchart-operator").data("operator_id"), e.data("connector"), e.data("sub_connector"), e.closest(".flowchart-operator-connector-set").data("connector_type")) }), this.objs.layers.links.on("mousedown touchstart", ".flowchart-link", function (t) { t.stopImmediatePropagation() }), this.objs.layers.links.on("mouseover", ".flowchart-link", function () { t._connecterMouseOver($(this).data("link_id")) }), this.objs.layers.links.on("mouseout", ".flowchart-link", function () { t._connecterMouseOut($(this).data("link_id")) }), this.objs.layers.links.on("click", ".flowchart-link", function () { t.selectLink($(this).data("link_id")) }), this.objs.layers.operators.on("mouseover", ".flowchart-operator", function (e) { t._operatorMouseOver($(this).data("operator_id")) }), this.objs.layers.operators.on("mouseout", ".flowchart-operator", function (e) { t._operatorMouseOut($(this).data("operator_id")) }) }, setData: function (t) { this._clearOperatorsLayer(), this.data.operatorTypes = {}, void 0 !== t.operatorTypes && (this.data.operatorTypes = t.operatorTypes), this.data.operators = {}; for (var e in t.operators) t.operators.hasOwnProperty(e) && this.createOperator(e, t.operators[e]); this.data.links = {}; for (var o in t.links) t.links.hasOwnProperty(o) && this.createLink(o, t.links[o]); this.redrawLinksLayer() }, addLink: function (t) { for (; void 0 !== this.data.links[this.linkNum];) this.linkNum++; return this.createLink(this.linkNum, t), this.linkNum }, createLink: function (t, e) { var o = $.extend(!0, {}, e); if (this.callbackEvent("linkCreate", [t, o])) { var r = this._getSubConnectors(o), n = r[0], a = r[1], i = this.options.multipleLinksOnOutput, s = this.options.multipleLinksOnInput; if (!i || !s) for (var l in this.data.links) if (this.data.links.hasOwnProperty(l)) { var c = this.data.links[l], p = this._getSubConnectors(c), h = p[0], u = p[1]; if (!i && c.fromOperator == o.fromOperator && c.fromConnector == o.fromConnector && h == n) { this.deleteLink(l); continue } s || c.toOperator != o.toOperator || c.toConnector != o.toConnector || u != a || this.deleteLink(l) } this._autoCreateSubConnector(o.fromOperator, o.fromConnector, "outputs", n), this._autoCreateSubConnector(o.toOperator, o.toConnector, "inputs", a), this.data.links[t] = o, this._drawLink(t), this.callbackEvent("afterChange", ["link_create"]) } }, _autoCreateSubConnector: function (t, e, o, r) { var n = this.data.operators[t].properties[o][e]; if (n.multiple) for (var a = this.data.operators[t].internal.els, i = this.data.operators[t].internal.els.connectors[e].length; i < r + 2; i++) this._createSubConnector(e, n, a) }, redrawLinksLayer: function () { this._clearLinksLayer(); for (var t in this.data.links) this.data.links.hasOwnProperty(t) && this._drawLink(t) }, _clearLinksLayer: function () { this.objs.layers.links.empty(), this.objs.layers.operators.find(".flowchart-operator-connector-small-arrow").css("border-left-color", "transparent") }, _clearOperatorsLayer: function () { this.objs.layers.operators.empty() }, getConnectorPosition: function (t, e, o) { var r = this.data.operators[t].internal.els.connectorArrows[e][o], n = r.offset(), a = this.element.offset(); return { x: (n.left - a.left) / this.positionRatio, width: parseInt(r.css("border-top-width")), y: (n.top - a.top - 1) / this.positionRatio + parseInt(r.css("border-left-width")) } }, getLinkMainColor: function (t) { var e = this.options.defaultLinkColor, o = this.data.links[t]; return void 0 !== o.color && (e = o.color), e }, setLinkMainColor: function (t, e) { this.data.links[t].color = e, this.callbackEvent("afterChange", ["link_change_main_color"]) }, _drawLink: function (t) { var e = this.data.links[t]; void 0 === e.internal && (e.internal = {}), e.internal.els = {}; var o = e.fromOperator, r = e.fromConnector, n = e.toOperator, a = e.toConnector, i = this._getSubConnectors(e), s = i[0], l = i[1], c = (this.getLinkMainColor(t), this.data.operators[o]), p = this.data.operators[n], h = c.internal.els.connectorSmallArrows[r][s], u = p.internal.els.connectorSmallArrows[a][l]; e.internal.els.fromSmallConnector = h, e.internal.els.toSmallConnector = u; var d = document.createElementNS("http://www.w3.org/2000/svg", "g"); this.objs.layers.links[0].appendChild(d), e.internal.els.overallGroup = d; var f = document.createElementNS("http://www.w3.org/2000/svg", "mask"), k = "fc_mask_" + this.globalId + "_" + this.maskNum; this.maskNum++, f.setAttribute("id", k), d.appendChild(f); var v = document.createElementNS("http://www.w3.org/2000/svg", "rect"); v.setAttribute("x", "0"), v.setAttribute("y", "0"), v.setAttribute("width", "100%"), v.setAttribute("height", "100%"), v.setAttribute("stroke", "none"), v.setAttribute("fill", "white"), f.appendChild(v); var m = document.createElementNS("http://www.w3.org/2000/svg", "polygon"); m.setAttribute("stroke", "none"), m.setAttribute("fill", "black"), f.appendChild(m), e.internal.els.mask = m; var C = document.createElementNS("http://www.w3.org/2000/svg", "g"); C.setAttribute("class", "flowchart-link"), C.setAttribute("data-link_id", t), d.appendChild(C); var b = document.createElementNS("http://www.w3.org/2000/svg", "path"); b.setAttribute("stroke-width", this.options.linkWidth.toString()), b.setAttribute("fill", "none"), C.appendChild(b), e.internal.els.path = b; var O = document.createElementNS("http://www.w3.org/2000/svg", "rect"); O.setAttribute("stroke", "none"), O.setAttribute("mask", "url(#" + k + ")"), C.appendChild(O), e.internal.els.rect = O, this._refreshLinkPositions(t), this.uncolorizeLink(t) }, _getSubConnectors: function (t) { var e = 0; void 0 !== t.fromSubConnector && (e = t.fromSubConnector); var o = 0; return void 0 !== t.toSubConnector && (o = t.toSubConnector), [e, o] }, _refreshLinkPositions: function (t) { var e = this.data.links[t], o = this._getSubConnectors(e), r = o[0], n = o[1], a = this.getConnectorPosition(e.fromOperator, e.fromConnector, r), i = this.getConnectorPosition(e.toOperator, e.toConnector, n), s = a.x, l = a.width, c = a.y, p = i.x, h = i.y; c += this.options.linkVerticalDecal, h += this.options.linkVerticalDecal; var u = this.options.distanceFromArrow; e.internal.els.mask.setAttribute("points", s + "," + (c - l - u) + " " + (s + l + u) + "," + c + " " + s + "," + (c + l + u)); var d = s + l + u, f = p + 1, k = Math.min(100, Math.max(Math.abs(d - f) / 2, Math.abs(c - h))); e.internal.els.path.setAttribute("d", "M" + d + "," + c + " C" + (s + l + u + k) + "," + c + " " + (p - k) + "," + h + " " + f + "," + h), e.internal.els.rect.setAttribute("x", s), e.internal.els.rect.setAttribute("y", c - this.options.linkWidth / 2), e.internal.els.rect.setAttribute("width", l + u + 1), e.internal.els.rect.setAttribute("height", this.options.linkWidth) }, getOperatorCompleteData: function (t) { void 0 === t.internal && (t.internal = {}), this._refreshInternalProperties(t); var e = $.extend(!0, {}, t.internal.properties); for (var o in e.inputs) e.inputs.hasOwnProperty(o) && null == e.inputs[o] && delete e.inputs[o]; for (var r in e.outputs) e.outputs.hasOwnProperty(r) && null == e.outputs[r] && delete e.outputs[r]; return void 0 === e.class && (e.class = this.options.defaultOperatorClass), e }, _getOperatorFullElement: function (t) { function e(t, e, o, r) { var n = $('<div class="flowchart-operator-connector-set"></div>'); n.data("connector_type", r), n.appendTo(o), c[t] = [], p[t] = [], u[t] = [], h[t] = n, l._createSubConnector(t, e, d) } var o = this.getOperatorCompleteData(t), r = $('<div class="flowchart-operator"></div>'); r.addClass(o.class); var n = $('<div class="flowchart-operator-title"></div>'); n.html(o.title), n.appendTo(r); var a = $('<div class="flowchart-operator-inputs-outputs"></div>'); a.appendTo(r); var i = $('<div class="flowchart-operator-inputs"></div>'); i.appendTo(a); var s = $('<div class="flowchart-operator-outputs"></div>'); s.appendTo(a); var l = this, c = {}, p = {}, h = {}, u = {}, d = { operator: r, title: n, connectorSets: h, connectors: u, connectorArrows: c, connectorSmallArrows: p }; for (var f in o.inputs) o.inputs.hasOwnProperty(f) && e(f, o.inputs[f], i, "inputs"); for (var k in o.outputs) o.outputs.hasOwnProperty(k) && e(k, o.outputs[k], s, "outputs"); return d }, _createSubConnector: function (t, e, o) { var r = o.connectorSets[t], n = o.connectors[t].length, a = $('<div class="flowchart-operator-connector"></div>'); a.appendTo(r), a.data("connector", t), a.data("sub_connector", n); var i = $('<div class="flowchart-operator-connector-label"></div>'); i.text(e.label.replace("(:i)", n + 1)), i.appendTo(a); var s = $('<div class="flowchart-operator-connector-arrow"></div>'); s.appendTo(a); var l = $('<div class="flowchart-operator-connector-small-arrow"></div>'); l.appendTo(a), o.connectors[t].push(a), o.connectorArrows[t].push(s), o.connectorSmallArrows[t].push(l) }, getOperatorElement: function (t) { return this._getOperatorFullElement(t).operator }, addOperator: function (t) { for (; void 0 !== this.data.operators[this.operatorNum];) this.operatorNum++; return this.createOperator(this.operatorNum, t), this.operatorNum }, createOperator: function (t, e) { function o(t, o) { e.top = o.top, e.left = o.left; for (var r in a.data.links) if (a.data.links.hasOwnProperty(r)) { var n = a.data.links[r]; n.fromOperator != t && n.toOperator != t || a._refreshLinkPositions(r) } } e.internal = {}, this._refreshInternalProperties(e); var r = this._getOperatorFullElement(e); if (!this.callbackEvent("operatorCreate", [t, e, r])) return !1; var n = this.options.grid; n && (e.top = Math.round(e.top / n) * n, e.left = Math.round(e.left / n) * n), r.operator.appendTo(this.objs.layers.operators), r.operator.css({ top: e.top, left: e.left }), r.operator.data("operator_id", t), this.data.operators[t] = e, this.data.operators[t].internal.els = r, t == this.selectedOperatorId && this._addSelectedClass(t); var a = this; if (this.options.canUserMoveOperators) { var i, s; r.operator.draggable({ containment: !e.internal.properties.uncontained && this.element, handle: ".flowchart-operator-title", start: function (t, e) { if (null == a.lastOutputConnectorClicked) { var o = a.element.offset(); i = (t.pageX - o.left) / a.positionRatio - parseInt($(t.target).css("left")), s = (t.pageY - o.top) / a.positionRatio - parseInt($(t.target).css("top")) } else t.preventDefault() }, drag: function (t, n) { if (a.options.grid) { var l = a.options.grid, c = a.element.offset(); if (n.position.left = Math.round(((t.pageX - c.left) / a.positionRatio - i) / l) * l, n.position.top = Math.round(((t.pageY - c.top) / a.positionRatio - s) / l) * l, !e.internal.properties.uncontained) { var p = $(this); n.position.left = Math.min(Math.max(n.position.left, 0), a.element.width() - p.outerWidth()), n.position.top = Math.min(Math.max(n.position.top, 0), a.element.height() - p.outerHeight()) } n.offset.left = Math.round(n.position.left + c.left), n.offset.top = Math.round(n.position.top + c.top), r.operator.css({ left: n.position.left, top: n.position.top }) } o($(this).data("operator_id"), n.position) }, stop: function (t, e) { a._unsetTemporaryLink(); var n = $(this).data("operator_id"); o(n, e.position), r.operator.css({ height: "auto" }), a.callbackEvent("operatorMoved", [n, e.position]), a.callbackEvent("afterChange", ["operator_moved"]) } }) } this.callbackEvent("afterChange", ["operator_create"]) }, _connectorClicked: function (t, e, o, r) { if ("outputs" == r) { new Date; this.lastOutputConnectorClicked = { operator: t, connector: e, subConnector: o }, this.objs.layers.temporaryLink.show(); var n = this.getConnectorPosition(t, e, o), a = n.x + n.width, i = n.y; this.objs.temporaryLink.setAttribute("x1", a.toString()), this.objs.temporaryLink.setAttribute("y1", i.toString()), this._mousemove(a, i) } if ("inputs" == r && null != this.lastOutputConnectorClicked) { var s = { fromOperator: this.lastOutputConnectorClicked.operator, fromConnector: this.lastOutputConnectorClicked.connector, fromSubConnector: this.lastOutputConnectorClicked.subConnector, toOperator: t, toConnector: e, toSubConnector: o }; this.addLink(s), this._unsetTemporaryLink() } }, _unsetTemporaryLink: function () { this.lastOutputConnectorClicked = null, this.objs.layers.temporaryLink.hide() }, _mousemove: function (t, e, o) { null != this.lastOutputConnectorClicked && (this.objs.temporaryLink.setAttribute("x2", t), this.objs.temporaryLink.setAttribute("y2", e)) }, _click: function (t, e, o) { var r = $(o.target); 0 == r.closest(".flowchart-operator-connector").length && this._unsetTemporaryLink(), 0 == r.closest(".flowchart-operator").length && this.unselectOperator(), 0 == r.closest(".flowchart-link").length && this.unselectLink() }, _removeSelectedClassOperators: function () { this.objs.layers.operators.find(".flowchart-operator").removeClass("selected") }, unselectOperator: function () { if (null != this.selectedOperatorId) { if (!this.callbackEvent("operatorUnselect", [])) return; this._removeSelectedClassOperators(), this.selectedOperatorId = null } }, _addSelectedClass: function (t) { this.data.operators[t].internal.els.operator.addClass("selected") }, callbackEvent: function (t, e) { var o = "on" + t.charAt(0).toUpperCase() + t.slice(1), r = this.options[o].apply(this, e); if (!1 !== r) { var n = { result: r }; this.element.trigger(t, e.concat([n])), r = n.result } return r }, selectOperator: function (t) { this.callbackEvent("operatorSelect", [t]) && (this.unselectLink(), this._removeSelectedClassOperators(), this._addSelectedClass(t), this.selectedOperatorId = t) }, addClassOperator: function (t, e) { this.data.operators[t].internal.els.operator.addClass(e) }, removeClassOperator: function (t, e) { this.data.operators[t].internal.els.operator.removeClass(e) }, removeClassOperators: function (t) { this.objs.layers.operators.find(".flowchart-operator").removeClass(t) }, _addHoverClassOperator: function (t) { this.data.operators[t].internal.els.operator.addClass("hover") }, _removeHoverClassOperators: function () { this.objs.layers.operators.find(".flowchart-operator").removeClass("hover") }, _operatorMouseOver: function (t) { this.callbackEvent("operatorMouseOver", [t]) && this._addHoverClassOperator(t) }, _operatorMouseOut: function (t) { this.callbackEvent("operatorMouseOut", [t]) && this._removeHoverClassOperators() }, getSelectedOperatorId: function () { return this.selectedOperatorId }, getSelectedLinkId: function () { return this.selectedLinkId }, _shadeColor: function (t, e) { var o = parseInt(t.slice(1), 16), r = e < 0 ? 0 : 255, n = e < 0 ? -1 * e : e, a = o >> 16, i = o >> 8 & 255, s = 255 & o; return "#" + (16777216 + 65536 * (Math.round((r - a) * n) + a) + 256 * (Math.round((r - i) * n) + i) + (Math.round((r - s) * n) + s)).toString(16).slice(1) }, colorizeLink: function (t, e) { var o = this.data.links[t]; o.internal.els.path.setAttribute("stroke", e), o.internal.els.rect.setAttribute("fill", e), o.internal.els.fromSmallConnector.css("border-left-color", e), o.internal.els.toSmallConnector.css("border-left-color", e) }, uncolorizeLink: function (t) { this.colorizeLink(t, this.getLinkMainColor(t)) }, _connecterMouseOver: function (t) { this.selectedLinkId != t && this.colorizeLink(t, this._shadeColor(this.getLinkMainColor(t), -.4)) }, _connecterMouseOut: function (t) { this.selectedLinkId != t && this.uncolorizeLink(t) }, unselectLink: function () { if (null != this.selectedLinkId) { if (!this.callbackEvent("linkUnselect", [])) return; this.uncolorizeLink(this.selectedLinkId, this.options.defaultSelectedLinkColor), this.selectedLinkId = null } }, selectLink: function (t) { this.unselectLink(), this.callbackEvent("linkSelect", [t]) && (this.unselectOperator(), this.selectedLinkId = t, this.colorizeLink(t, this.options.defaultSelectedLinkColor)) }, deleteOperator: function (t) { this._deleteOperator(t, !1) }, _deleteOperator: function (t, e) { if (!this.callbackEvent("operatorDelete", [t, e])) return !1; if (!e) for (var o in this.data.links) if (this.data.links.hasOwnProperty(o)) { var r = this.data.links[o]; r.fromOperator != t && r.toOperator != t || this._deleteLink(o, !0) } e || t != this.selectedOperatorId || this.unselectOperator(), this.data.operators[t].internal.els.operator.remove(), delete this.data.operators[t], this.callbackEvent("afterChange", ["operator_delete"]) }, deleteLink: function (t) { this._deleteLink(t, !1) }, _deleteLink: function (t, e) { if (this.selectedLinkId == t && this.unselectLink(), this.callbackEvent("linkDelete", [t, e]) || e) { this.colorizeLink(t, "transparent"); var o = this.data.links[t], r = o.fromOperator, n = o.fromConnector, a = o.toOperator, i = o.toConnector; o.internal.els.overallGroup.remove(), delete this.data.links[t], this._cleanMultipleConnectors(r, n, "from"), this._cleanMultipleConnectors(a, i, "to"), this.callbackEvent("afterChange", ["link_delete"]) } }, _cleanMultipleConnectors: function (t, e, o) { if (this.data.operators[t].properties["from" == o ? "outputs" : "inputs"][e].multiple) { var r = -1, n = o + "Operator", a = o + "Connector", i = o + "SubConnector", s = this.data.operators[t].internal.els, l = s.connectors[e], c = l.length; for (var p in this.data.links) if (this.data.links.hasOwnProperty(p)) { var h = this.data.links[p]; h[n] == t && h[a] == e && r < h[i] && (r = h[i]) } for (var u = Math.min(c - r - 2, c - 1), d = 0; d < u; d++) l[l.length - 1].remove(), l.pop(), s.connectorArrows[e].pop(), s.connectorSmallArrows[e].pop() } }, deleteSelected: function () { null != this.selectedLinkId && this.deleteLink(this.selectedLinkId), null != this.selectedOperatorId && this.deleteOperator(this.selectedOperatorId) }, setPositionRatio: function (t) { this.positionRatio = t }, getPositionRatio: function () { return this.positionRatio }, getData: function () { var t = ["operators", "links"], e = {}; e.operators = $.extend(!0, {}, this.data.operators), e.links = $.extend(!0, {}, this.data.links); for (var o in t) if (t.hasOwnProperty(o)) { var r = t[o]; for (var n in e[r]) e[r].hasOwnProperty(n) && delete e[r][n].internal } return e.operatorTypes = this.data.operatorTypes, e }, setOperatorTitle: function (t, e) { this.data.operators[t].internal.els.title.html(e), void 0 === this.data.operators[t].properties && (this.data.operators[t].properties = {}), this.data.operators[t].properties.title = e, this._refreshInternalProperties(this.data.operators[t]), this.callbackEvent("afterChange", ["operator_title_change"]) }, getOperatorTitle: function (t) { return this.data.operators[t].internal.properties.title }, setOperatorData: function (t, e) { var o = this.getOperatorCompleteData(e); for (var r in this.data.links) if (this.data.links.hasOwnProperty(r)) { var n = this.data.links[r]; (n.fromOperator == t && void 0 === o.outputs[n.fromConnector] || n.toOperator == t && void 0 === o.inputs[n.toConnector]) && this._deleteLink(r, !0) } this._deleteOperator(t, !0), this.createOperator(t, e), this._refreshOperatorConnectors(t), this.redrawLinksLayer(), this.callbackEvent("afterChange", ["operator_data_change"]) }, _refreshOperatorConnectors: function (t) { for (var e in this.data.links) if (this.data.links.hasOwnProperty(e)) { var o = this.data.links[e]; if (o.fromOperator == t || o.toOperator == t) { var r = this._getSubConnectors(o), n = r[0], a = r[1]; this._autoCreateSubConnector(o.fromOperator, o.fromConnector, "outputs", n), this._autoCreateSubConnector(o.toOperator, o.toConnector, "inputs", a) } } }, doesOperatorExists: function (t) { return void 0 !== this.data.operators[t] }, getOperatorData: function (t) { var e = $.extend(!0, {}, this.data.operators[t]); return delete e.internal, e }, getLinksFrom: function (t) { var e = []; for (var o in this.data.links) if (this.data.links.hasOwnProperty(o)) { var r = this.data.links[o]; r.fromOperator === t && e.push(r) } return e }, getLinksTo: function (t) { var e = []; for (var o in this.data.links) if (this.data.links.hasOwnProperty(o)) { var r = this.data.links[o]; r.toOperator === t && e.push(r) } return e }, getOperatorFullProperties: function (t) { if (void 0 !== t.type) { var e = this.data.operatorTypes[t.type], o = {}; return void 0 !== t.properties && (o = t.properties), $.extend({}, e, o) } return t.properties }, _refreshInternalProperties: function (t) { t.internal.properties = this.getOperatorFullProperties(t) } }) });